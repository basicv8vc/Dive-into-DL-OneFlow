
# 日常生活中的机器学习

假设你正和本书的作者们一起，驱车去咖啡店。
亚历山大拿起一部iPhone，对它说道“Hey Siri”--手机的语音识别系统主动唤醒了。
接着，李沐对Siri说道“去星巴克咖啡店”--语音识别系统自动触发语音转文字功能，并启动地图应用程序来满足我们的请求。
地图应用程序在启动后确定了若干条路线：每条路线都显示了预计的通行时间......
由此可见，机器学习渗透在生活中的方方面面，在短短几秒钟的时间里，我们与智能手机的日常互动就可以涉及几种机器学习模型。

现在，请你从基本原则出发，编写一个程序来响应一个“唤醒词”（比如“Alexa”、“小爱同学”和“Hey Siri”）。
试着用一台计算机和一个代码编辑器自己编写代码，如图1.1.1中所示。
问题看似很难解决：麦克风每秒钟将收集大约44000个样本，每个样本都是声波振幅的测量值。
如何编写程序，令其输入原始音频片段，输出$\{\text{是}, \text{否}\}$（表示该片段是否包含唤醒词）的可靠预测呢？
如果你毫无头绪，别担心，我们也不知道如何从头开始编写这个程序。这就是我们需要机器学习的原因。

<div align=center>
<img width=500 src="../img/wake-word.svg"/>
</div>
<center>图1.1.1 识别唤醒词</center>



显然，即使我们不知道如何编程从输入到输出的映射，人类大脑认知仍然能够执行这个任务。
换句话说，即使你不知道如何编写程序来识别单词“Alexa”，你的大脑却能够轻易识别它。
有了这一能力，我们就可以收集一个包含音频样本的巨大的*数据集*（dataset），并对包含和不包含唤醒词的样本进行标记。
通过机器学习算法，我们不需要设计一个“明确地”识别唤醒词的系统。
相反，我们定义一个灵活的程序算法，其输出由许多*参数*（parameter）决定。
然后我们使用数据集来确定当下的“最佳参数集”，这些参数通过某种性能度量来获取完成任务的最佳性能。

那么到底什么是参数呢？
你可以把参数看作是旋钮，我们可以转动旋钮来调整程序的行为。
任一调整参数的程序后，我们称为*模型*（model）。
通过操作参数而生成的所有不同程序（输入-输出映射）的集合称为“模型族”。
使用数据集来选择参数的元程序被称为*学习算法*（learning algorithm）。

在我们开始用机器学习算法解决问题之前，我们必须精确地定义问题，确定输入和输出的性质，并选择合适的模型族。
在本例中，我们的模型接收一段音频作为*输入*（input），然后模型生成$\{\text{是}, \text{否}\}$中的*输出*（output）。
如果一切顺利，经过一番训练，模型对于“片段是否包含唤醒词“的预测通常是正确的。

现在我们的模型每次听到“Alexa”这个词时都会发出“是”的声音。
由于这里的唤醒词是任意选择的自然语言，因此我们可能需要一个足够丰富的模型族，使模型多元化。
比如，模型族的另一个模型只在听到“Hey Siri”这个词时发出“是”。
理想情况下，同一个模型族应该适合于“Alexa”识别和“Hey Siri”识别，因为它们似乎是相似的任务。
相反，如果我们想处理完全不同的输入或输出，比如从图像映射到字幕，或从英语映射到中文，我们可能需要一个完全不同的模型族。

正如你可能猜到的，如果我们只是随机设置模型参数，所以这个模型不太可能识别出“Alexa”、“Hey Siri”或任何其他单词。
在机器学习中，*学习*（learning）是一个模型的训练过程。
通过这个过程，我们可以发现正确的参数集，从而从使模型强制执行所需的行为。
换句话说，我们用数据*训练*（train）我们的模型。
如图1.1.2所示，训练过程通常包含如下步骤：

1. 从一个随机初始化参数的模型开始，这个模型基本毫不“智能”。
2. 获取一些数据样本（例如，音频片段以及对应的$\{\text{是}, \text{否}\}$标签）。
3. 调整参数，使模型在这些样本中表现得更好。
4. 重复第2步和第3步，直到模型在任务中的表现令你满意。


<div align=center>
<img width=500 src="../img/ml-loop.svg"/>
</div>
<center>图1.1.2 一个典型的训练过程</center>


总而言之，我们没有编写唤醒词识别器，而是编写了一个“学习”程序。
如果我们用一个巨大的带标签的数据集，它很可能可以“学习”识别唤醒词。
你可以将这种“通过用数据集来确定程序行为”的方法看作是“用数据编程”（programming with data）。
比如，我们可以通过向机器学习系统提供许多猫和狗的图片来设计一个“猫图检测器”。
通过这种方式，检测器最终可以学会：如果输入是猫的图片就输出一个非常大的正数，如果输入是狗的图片就会得出一个非常大的负数。
如果检测器不确定，它会输出接近于零的数......
这个例子仅仅是机器学习常见应用的冰山一角。
而深度学习是机器学习的一个主要分支，我们稍后将对其进行更详细的解析。
